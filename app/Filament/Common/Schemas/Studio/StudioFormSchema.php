<?php

namespace App\Filament\Common\Schemas\Studio;

use App\Models\Enums\ProductTypeCast;
use App\Models\Product\Product;
use App\Models\Project\Project;
use App\Models\Subscription\Plan;
use App\Services\MoneyService\Money;
use Filament\Forms;
use Filament\Forms\Components\Wizard;
use Illuminate\Support\Facades\Blade;
use Illuminate\Support\HtmlString;


trait StudioFormSchema
{


    public function getStudioFormSchema():array
    {
        return [
            Wizard::make([
                Wizard\Step::make('Studio')
                    ->icon('heroicon-c-squares-2x2')
                    ->schema([

                        Forms\Components\Section::make('Studio Information')
                            ->aside()
                            ->columns(4)
                            ->description(fn() => $this->getStudioInfoSectionDescription())
                            ->schema([

                                Forms\Components\Select::make('domain_schema')
                                    ->required()
                                    ->label('Schema')
                                    ->live()
                                    ->options([
                                        'https://' => 'https://',
                                        'http://' => 'http://',
                                    ])
                                    ->helperText('set domain schema')
                                    ->default('http://'),

                                Forms\Components\TextInput::make('domain')
                                    ->required()
                                    ->label('Set Domain')
                                    ->columnSpan(3)
                                    ->lazy()
                                    ->prefix(fn(Forms\Get $get) => $get('domain_schema'))
                                    ->helperText(fn(Forms\Get $get,$state) => $state ? 'Studio Url : '.$get('domain_schema').$state : 'type your domain name')
                                    // ->afterStateUpdated(fn(Forms\Set $set,Forms\Get $get,$state) => $set('url',Hash::make($get('domain_schema').$state)))
                                    ->maxLength(255),

                                Forms\Components\TextInput::make('name')
                                    ->required()
                                    ->label('Studio Name')
                                    ->prefixIcon('heroicon-c-squares-2x2')
                                    ->columnSpanFull()
                                    ->maxLength(255),
//                                    Forms\Components\TextInput::make('url')
//                                        ->required()
//                                        ->label('Studio')
//                                        ->prefixIcon('heroicon-c-bookmark-square')
//                                        ->columnSpanFull()
//                                        ->disabled()
//                                        ->maxLength(255),
                            ]),

                    ]),

                Wizard\Step::make('Product')
                    ->icon('heroicon-m-square-3-stack-3d')
                    ->schema([

                        Forms\Components\Section::make('Choose Product')
                            ->aside()
                            ->description(fn() => $this->getProductSectionDescription())
                            ->schema([
                                Forms\Components\Select::make('project_id')
                                    ->label('Choose Project')
                                    ->placeholder('Select a project')
                                    ->prefixIcon('heroicon-c-squares-2x2')
                                    ->options(fn() => Project::where('status',true)->get()->pluck('name','id')->toArray())
                                    ->live()
                                    ->columnSpanFull()
                                    ->required(),

                                Forms\Components\Select::make('product_id')
                                    ->label('Choose Product')
                                    ->placeholder('Select a product')
                                    ->prefixIcon('heroicon-c-squares-2x2')
                                    ->options(function (Forms\Get $get){
                                        $selectedProject = Project::with([
                                            'products' => fn($q) => $q->where('status',true)
                                        ])->firstWhere('id',$get('project_id'));
                                        return $selectedProject ? $selectedProject->products->pluck('name','id')->toArray() : [];
                                    })
                                    ->live()
                                    ->required(),

                                Forms\Components\Select::make('addon_id')
                                    ->label('AddOns')
                                    ->searchable()
                                    ->placeholder('Select Addon Products')
                                    ->prefixIcon('heroicon-c-squares-2x2')
                                    ->searchingMessage('Searching Addons')
                                    ->getSearchResultsUsing(fn (string $search): array => Product::where([
                                        ['type','=',ProductTypeCast::STANDARD],
                                        ['status','=',true],
                                        ['name', 'like', "%{$search}%"]
                                    ])->limit(50)->pluck('name', 'id')->toArray())
                                    ->options(fn() => Product::where([
                                        ['type','=',ProductTypeCast::STANDARD],
                                        ['status','=',true]
                                    ])->get()->pluck('name','id')->toArray())
                                    ->multiple()
                                    ->nullable(),
                            ])


                    ]),

                Wizard\Step::make('Configuration')
                    ->columns()
                    ->icon('heroicon-m-cog')
                    ->schema([

                        Forms\Components\Grid::make(1)
                            ->columnSpan(1)
                            ->schema([
                                Forms\Components\Select::make('plan_id')
                                    ->label('Choose Plan')
                                    ->placeholder('Select a plan')
                                    ->prefixIcon('heroicon-c-squares-2x2')
                                    ->options(fn() => Plan::all()->pluck('name','id')->toArray())
                                    ->live()
                                    ->afterStateUpdated(function (Forms\Set $set, $state){
                                        $this->plan = Plan::firstWhere('id',$state);
                                        $set('price',$this->plan->price);
                                        $set('per_month_limit',$this->plan->per_month_limit);
                                        $set('plan_features',$this->plan->features);
                                    })
                                    ->required(),


                                Forms\Components\Select::make('duration_month')
                                    ->label('Duration (Month) :')
                                    ->placeholder('Select duration months')
                                    ->prefixIcon('heroicon-c-squares-2x2')
                                    ->options([
                                        null => 'Free Forever',
                                        3 => '03 Months',
                                        6 => '06 Months',
                                        12 => '12 Months',
                                        24 => '24 Months',
                                        36 => '36 Months',
                                    ])->required(),


                            ]),

                        Forms\Components\Placeholder::make('plan_details')
                            ->label('Plan Features')
                            ->hiddenLabel()
                            ->content(fn() => $this->getPlanInfoDetails()),
                    ]),
                Wizard\Step::make('Order')
                    ->icon('heroicon-s-shopping-cart')
                    ->schema([
                        // ...
                    ]),
            ])
                ->columnSpanFull()
                ->skippable()
                ->submitAction(new HtmlString(Blade::render(<<<BLADE
                        <x-filament::button
                            type="submit"
                            size="sm"
                        >
                            Submit
                        </x-filament::button>
                    BLADE))),
        ];
    }





    protected function getStudioInfoSectionDescription(): HtmlString
    {
        return new HtmlString('

            <svg xmlns="http://www.w3.org/2000/svg" class="w-full p-2" viewBox="0 0 507.99631 486.46461" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="m339.28132,144.85552c-1.7577,2.08666-3.98893,3.72206-6.50814,4.76945l-7.21532,8.12517-20.43689,24.67773-13.80738,8.35194-6.41109-11.03715,30.26457-29.48015,8.43338-8.58048c.67621-2.64418,1.97584-5.08773,3.79079-7.1256,4.4675-5.16172,10.75245-7.03932,14.03602-4.19587,3.28421,2.84414,2.32391,9.33233-2.14593,14.49496Z" fill="#ffafaf"/><path d="m215.75649,169.37563l13.29016-22.11774,56.5433,24.29522,30.90638-25.25171s12.2617,10.56233,12.69962,10.93955-31.16616,44.15089-33.41028,44.09926c-2.24412-.05162-80.02919-31.96459-80.02919-31.96459Z" fill="#dedede"/></g><path d="m0,479.24451c0,.66003.53003,1.19,1.19006,1.19h505.61625c.65997,0,1.19-.52997,1.19-1.19,0-.65997-.53003-1.19-1.19-1.19H1.19006c-.66003,0-1.19006.53003-1.19006,1.19Z" fill="#3f3d58"/><g><path d="m343.37799,0c40.25244,0,73,30.72852,73,68.5,0,10.55371-2.62939,21.05078-7.61865,30.46875h.06006l-1.32129,2.29688c-11.2124,19.31543-17.43848,41.3125-18.00342,63.61133-.17139,6.79785-5.6333,12.12305-12.43359,12.12305h-56.88623c-7.33008,0-13.48633-5.25439-14.6377-12.49316-2.80176-17.6123-8.40527-34.58301-16.65332-50.44238-11.93457-12.55957-18.50586-28.73633-18.50586-45.56445C270.37799,30.72852,303.12604,0,343.37799,0Zm62.35107,100.3291l.47314-.85156c5.34863-9.49414,8.17578-20.20605,8.17578-30.97754,0-36.66797-31.85059-66.5-71-66.5s-71,29.83203-71,66.5c0,16.3584,6.41016,32.08594,18.05078,44.28711l.16309.22852c8.38379,16.08594,14.07715,33.30469,16.91992,51.17676.99609,6.26221,6.32227,10.80762,12.66309,10.80762h56.88623c5.70703,0,10.29004-4.46875,10.43457-10.17383.57227-22.60645,6.87695-44.90723,18.2334-64.49707Z" fill="#3f3d56"/><path d="m384.93105,172.00015h-75.10596c-2.38802,0-4.26057,2.0505-4.04437,4.42871l.70322,7.73563c.58849,6.4735,2.63111,12.73056,5.97549,18.3044h0c.55924.93206,1.61518,1.44245,2.69433,1.31238,22.25527-2.68252,44.03088-2.77033,65.28482-.03885,1.16266.14942,2.29074-.44478,2.81498-1.49325l.48135-.9627c2.40753-4.81506,3.8933-10.03792,4.38068-15.39922l.85983-9.45839c.2162-2.37821-1.65635-4.42871-4.04437-4.42871Z" fill="#3f3d56"/><path d="m317.37807,198.50015h61.5v40.02791c0,7.15949-5.8126,12.97209-12.97209,12.97209h-35.55581c-7.15949,0-12.97209-5.8126-12.97209-12.97209v-40.02791h0Z" fill="#3f3d56"/><path d="m356.04202,262.00015h-13.32791c-1.466,0-2.84175-.70799-3.69384-1.90092l-8.6422-12.09908h38l-8.6422,12.09908c-.85209,1.19293-2.22785,1.90092-3.69384,1.90092Z" fill="#3f3d56"/><path d="m366.12615,35.32647c-9.78508,2.02614-19.57015,4.05229-29.35523,6.07843-4.40004.91109-9.32793,1.38395-13.32571,3.57071-3.87589,2.12009-6.59038,6.56839-5.20384,11.0215,1.32408,4.25251,5.23235,6.92014,9.42433,7.86845,4.65106,1.05217,9.63356,1.04475,14.37444,1.41071,4.9449.38171,9.8898.76341,14.8347,1.14512,2.35337.18166,4.71905.30711,7.06693.54884.751.07732,1.56979.16944,2.18644.64589-.0093-.00719.20836.12917.08769.15012-.02354.00409-.02548-.1543-.02207-.16491.09529-.29674.05612-.01596-.02075-.01525-.02699.00025-.73526.46812-1.13042.54199-1.06603.1993-2.24216.05431-3.32237.03591-2.34708-.03998-4.69541.00436-7.03935.13214-4.71747.25718-9.42845.84396-14.06835,1.73284-4.56402.87434-9.10646,2.03846-13.48968,3.58913-4.24986,1.5035-8.70105,4.35866-8.81664,9.39621-.10856,4.73132,3.996,8.0562,8.17609,9.24474,2.14995.6113,4.41565.83289,6.62081,1.16093,2.46033.366,4.92067.732,7.381,1.098,4.83866.7198,9.67731,1.4396,14.51597,2.15939,2.46033.366,4.92067.732,7.381,1.098,1.14726.17067,2.30106.3178,3.44447.5124.42158.07175.8192.20433,1.23503.28965-.27921-.05729.06722-.05682.01.00821.18217.11163.18258.09478.00123-.05057l-.12357-.18156c-.28234-.79255-.27258-.89695.2426-1.8342.09836-.17895.29818.00572.04346-.02243-.27188-.03004.16303-.03404-.12656.08556-.14478.05979-.30217.10049-.45291.14219-1.13922.31519-2.33285.47986-3.4924.70755-2.41053.47332-4.82107.94664-7.2316,1.41996-4.74071.93086-9.48148,1.86146-14.22214,2.79259-8.35115,1.64029-17.22027,3.8587-22.225,11.39391-1.08873,1.63921-1.87883,3.52803-2.27347,5.45482-.3248,1.58578.45984,3.24097,2.09532,3.69036,1.48351.40763,3.36372-.50056,3.69036-2.09532,1.58533-7.74015,10.055-10.51989,17.02006-11.99627,4.61722-.97871,9.26281-1.83505,13.89412-2.74444,4.66759-.91651,9.40939-1.66266,14.0371-2.76137,1.9455-.4619,4.05633-1.65799,4.60012-3.7324.59537-2.27118-.52565-4.46368-2.5843-5.52174-1.97445-1.01478-4.3215-1.09484-6.47893-1.41577-2.37832-.3538-4.75665-.7076-7.13497-1.0614-4.83866-.7198-9.67731-1.4396-14.51597-2.15939-2.37832-.3538-4.75665-.7076-7.13497-1.0614-2.20524-.32805-4.47061-.54956-6.62081-1.16093-1.45474-.41363-2.94324-1.12339-3.58581-2.50851-.20717-.44658-.26047-.7716-.119-1.27388.19418-.68946.73416-1.33156,1.3351-1.80673,1.38526-1.09533,3.26028-1.58401,4.90692-2.1123,2.16064-.6932,4.34524-1.31168,6.54859-1.85409,4.37442-1.07688,8.82057-1.86498,13.30492-2.30181,2.33636-.22759,4.68064-.37227,7.02727-.43316,2.22033-.05761,4.44462.07999,6.66212.0113,2.36368-.07321,4.7965-.70515,6.41923-2.53748,1.66997-1.88567,2.07596-4.4605.91412-6.72101-2.29915-4.47333-8.39123-4.03382-12.63808-4.36164-4.86248-.37534-9.72497-.75069-14.58745-1.12603-4.54681-.35098-9.22151-.4249-13.72887-1.12463-1.66926-.25914-3.59306-.73621-4.85191-1.73087-1.15405-.91186-1.9032-2.10742-1.81149-3.30544.08531-1.1144,1.22331-2.34531,2.41464-3.02936,1.67141-.95972,3.64349-1.31787,5.51016-1.70703,9.60699-2.00283,19.21945-3.97979,28.82914-5.96962,2.36473-.48965,4.72945-.9793,7.09418-1.46895,1.58727-.32867,2.50472-2.20063,2.09532-3.69036-.45286-1.64789-2.09848-2.42494-3.69036-2.09532h0Z" fill="#7e58ec"/></g><rect x="220.374" y="131.00008" width="19.65164" height="38.14729" fill="#ffafaf"/><path d="m272.4694,237.29842l-47.39512-3.46794s-19.65164,45.08316-4.62391,73.98263l10.40381,60.11088-4.11409,98.93814h21.52698l33.45017-159.04903-9.24783-70.51469Z" fill="#2f2e41"/><polygon points="263.22157 287.79173 281.71723 303.89042 272.4694 461.55826 251.66179 461.55826 263.22157 287.79173" fill="#2f2e41"/><circle cx="229.93432" cy="113.93163" r="24.56883" fill="#ffafaf"/><path d="m226.9916,443.38148l25.37943,4.0095,4.76997,18.20598s20.60701,7.75462,10.67776,16.18143c-9.92926,8.42681-46.61071,4.07002-49.5109-1.97463s8.68374-36.42227,8.68374-36.42227Z" fill="#2f2e41"/><path d="m247.79921,443.38148l25.37943,4.0095,4.76997,18.20598s20.60701,7.75462,10.67776,16.18143c-9.92926,8.42681-46.61071,4.07002-49.5109-1.97463-2.90019-6.04465,8.68374-36.42227,8.68374-36.42227Z" fill="#2f2e41"/><path d="m317.91302,233.38836c-2.72814.03013-5.42343-.59303-7.86116-1.81815l-10.86519-.16383-32.03545.62181-15.33933-5.01036,4.17817-12.06083,42.0881,3.68989,12.00513.78955c2.44471-1.2134,5.14429-1.82351,7.87283-1.77842,6.82654.01602,12.35101,3.55244,12.33967,7.89606-.01143,4.34454-5.554,7.85149-12.38277,7.83429Z" fill="#ffafaf"/><path d="m241.83597,145.39813h-24.32173l-8.04567,24.27555,15.60571,64.15681,47.39512,3.46794-2.88995-26.00952v-.00002c5.5955-9.09267,5.14898-20.66363-1.1306-29.29804l-26.61289-36.59272Z" fill="#dedede"/><path d="m218.7164,155.80194l25.43153-4.3658,18.49566,58.69679,39.30327,6.93587v16.76169c0,.57799-53.79192,5.2019-55.21743,3.46794-1.42552-1.73397-28.01302-81.49649-28.01302-81.49649Z" fill="#dedede"/><path d="m242.20224,99.6872c3.0182,4.89641.23544,11.34568-3.48262,15.73434s-8.5123,8.24091-10.17231,13.74806c-1.48833,4.93758-.13451,10.26267,1.61586,15.11355,1.75037,4.85088,3.9266,9.68736,4.10704,14.84122.18044,5.15386-2.25871,10.84543-7.11336,12.58531-4.9817,1.78542-10.8712-1.02037-15.66949,1.21154-6.24995,2.90715-7.66621,12.972-14.47977,14.01544-4.19317.64215-8.0793-2.99326-9.2512-7.07022-1.17191-4.07697-.33022-8.42859.51692-12.5852,2.32107-11.38866,4.64215-22.77731,6.96322-34.16597,1.93126-9.476,3.86253-18.952,5.79379-28.428,1.15307-5.65769,2.5212-11.70956,6.77327-15.61583,5.19577-4.77321,13.02743-4.88668,20.07709-4.60062,6.477.26282,13.21543.70598,18.85408,3.90382,5.63865,3.19784,9.7803,9.99526,7.82913,16.17697-1.82241-4.35077-7.26723-6.7915-11.72774-5.25714" fill="#2f2e41"/></svg>

        ');
    }



    protected function getProductSectionDescription(): HtmlString
    {
        return new HtmlString('

            <svg xmlns="http://www.w3.org/2000/svg" data-name="Layer 1" class="w-full p-2" viewBox="0 0 735.16469 684.28538" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M940.79492,190h7.30066c5.593-42.93854-37.44061-75.54559-86.79895-79.52624A105.83718,105.83718,0,0,1,940.79492,190Z" transform="translate(-232.41766 -107.85731)" fill="#f2f2f2"/><path d="M827.18768,318.11091q-6.19721-.07561-11.87463-.41815A50.57516,50.57516,0,0,0,827.18768,318.11091Z" transform="translate(-232.41766 -107.85731)" fill="#f2f2f2"/><path d="M735.32385,213.34773c.95258-56.559,46.02069-102.58771,102.58844-102.58771a125.18083,125.18083,0,0,1,23.38434-.28625,105.52282,105.52282,0,0,0-128.87549,102.874c0,53.63012,1.91907,99.38489,82.89191,104.345C774.289,311.462,734.57587,257.75917,735.32385,213.34773Z" transform="translate(-232.41766 -107.85731)" fill="#f2f2f2"/><path d="M939.58521,215c-18.54316,31.7226-91.45185,54.98731-101.67292,100.93689a46.80065,46.80065,0,0,1-10.72461,2.174c3.35968.041,6.8255.02771,10.42749-.055,57.61542,0,104.87439-45.66156,105.76715-103.05585Z" transform="translate(-232.41766 -107.85731)" fill="#f2f2f2"/><path d="M846.19145,290.43711c-13.48355-29.25072-19.3881-60.77515-15.25269-95.31151-.63891-4.01772,1.60067-8.04395,5.00634-9.0002l61.045-17.0549c3.40711-.94712,6.68847,1.53668,7.33507,5.55226l15.25275,95.31151c.63892,4.01772-1.6006,8.044-5.00626,9.00014l-61.045,17.05489C850.11955,296.93642,846.83812,294.45269,846.19145,290.43711Z" transform="translate(-232.41766 -107.85731)" fill="#f2f2f2"/><ellipse cx="864.81216" cy="178.28462" rx="12.43264" ry="10.37768" transform="translate(344.76101 905.26409) rotate(-82.63777)" fill="#f2f2f2"/><path d="M763.47082,243.82723c-13.48356-29.25072-19.38811-60.77515-15.2527-95.31151-.63891-4.01772,1.60067-8.04395,5.00634-9.0002l61.045-17.0549c3.40711-.94712,6.68847,1.53668,7.33507,5.55226l15.25275,95.31151c.63892,4.01772-1.6006,8.044-5.00626,9.00014l-61.045,17.05489C767.39891,250.32654,764.11748,247.84281,763.47082,243.82723Z" transform="translate(-232.41766 -107.85731)" fill="#f2f2f2"/><ellipse cx="782.09152" cy="131.67474" rx="12.43264" ry="10.37768" transform="translate(318.86597 782.58821) rotate(-82.63777)" fill="#f2f2f2"/><rect y="452.63742" width="614.60645" height="2" fill="#3f3d56"/><path d="M482.41766,324.49473c-.725-2.53751,9.41132,20.72,7,21-10.98269,1.26-35.31853,6.94-42.96788,10-.34451-.04-.689-.08-1.02331-.13-.82065-.09-1.62109-.22-2.41132-.37-17.81139-3.37-31.28642-18-31.65114-35.66-.02028-.25-.02028-.51-.02028-.76a33.47951,33.47951,0,0,1,.1925-3.65,34.33268,34.33268,0,0,1,.86116-4.91l-.0405-.00995c-7.09213-6.66-4.10329-19.01,4.93409-24.22a32.5508,32.5508,0,0,1,12.78608-4.15,34.279,34.279,0,0,1,3.67778-.2h11.53992a53.63143,53.63143,0,0,1,7.24406-1.05h.02028c23.23178-1.77,41.54974,12.39,39.8375,29.62-.01014.02-.03043.04-.04051.06-.4965.74-.93215,1.44-1.31716,2.11-.37486.63-.68894,1.23-.96245,1.8-2.11753,4.4,3.32552,9.93661-.2837,10.97-4.80026,1.37445,12.62488,46.55-6.37512,46.55C492.65969,374.12241,484.41766,331.49473,482.41766,324.49473Z" transform="translate(-232.41766 -107.85731)" fill="#2f2e41"/><polygon points="356.007 653.298 370.991 653.171 377.622 594.033 355.51 594.219 356.007 653.298" fill="#ffb6b6"/><path d="M636.41749,784.98081a6.70746,6.70746,0,0,1-6.64132,6.75737l-29.78956.24859-5.21507-10.57088-1.91533,10.62485-11.24025.10195,2.83831-37.89483,3.91065-.26017,15.95083-1.09955,5.14613-.34462.09025,10.72188,23.92992,16.231A6.69637,6.69637,0,0,1,636.41749,784.98081Z" transform="translate(-232.41766 -107.85731)" fill="#2f2e41"/><path d="M607.41766,731.49473c-5.96-.72-21-2-21-2s-7.1-14.82-5.95-19.43c1.13-4.63,3.95-5.57,1.33-7.99006-6.38-23.57995-5.36-61.87994-5.36-61.87994s-34.34-16.63-69.11-35.88c-33.99-18.83-68.38995-40.16-71.5-50.91a136.94481,136.94481,0,0,1-4.12-23.47c-.51995-5.2-.84-10.3-1.04-14.87-.47-10.46-.28-18.19-.28-18.19l43.33-.72,28.7-.66h3v5l7.54,12.82s13.03,15.15,11.5,16.56c-1.85,1.71-1.29,3.23,5.28,4.47a21.36163,21.36163,0,0,0,5.66.23c10.61-.81,15.05,5.26,15.31,6.59,1.78,9.39,19.63,29.79,36.35,47.2h.01c15.43,16.08,29.89,29.6,29.89,29.6l.82,17.25,3.85,80.65s-7.22-4.04-.77,4.67C627.30767,729.25474,613.37768,732.20469,607.41766,731.49473Z" transform="translate(-232.41766 -107.85731)" fill="#2f2e41"/><polygon points="537.561 436.107 543.678 422.427 492.655 391.8 483.627 411.987 537.561 436.107" fill="#ffb6b6"/><path d="M811.60652,510.22883a6.70747,6.70747,0,0,1,3.38287,8.85017l-12.16411,27.194-11.78222.34591,8.86561,6.16092-4.58237,10.26428-33.281-18.34249,1.38993-3.66455,5.6344-14.963,1.827-4.82322,9.788,4.3774,24.71347-15.011A6.69638,6.69638,0,0,1,811.60652,510.22883Z" transform="translate(-232.41766 -107.85731)" fill="#2f2e41"/><path d="M743.73324,510.85508c-.03479.078-.07675.149-.11172.21286-2.78777,5.11668-7.3629,16.95567-7.64805,17.6859a.10891.10891,0,0,0-.01387.04247s-15.09507-.77769-18.95292-3.5455c-3.8651-2.78895,1.9835,1.62042-6.92917-4.21139-4.60912-3.03153-20.3949-7.76456-34.53447-11.63162-13.15489-3.59773-24.87628-6.427-24.87628-6.427s-10.36109,9.43038-25.37255,22.46216l-.007.00712c-13.94293,12.07729-31.91016,27.26405-49.32212,40.86326-37.27819,10.96476-76.6237,20.46519-86.45949,15.1274a136.94528,136.94528,0,0,1-19.59849-13.55409l10.12844-26.54824L506.821,513.2877l28.19549-11.45664,11.0299-4.48491,15.44484-6.26751,83.62039-33.9748,92.60318,32.07508s-6.45011,5.21137,4.04678,2.46246C752.11719,488.93582,746.646,505.36992,743.73324,510.85508Z" transform="translate(-232.41766 -107.85731)" fill="#2f2e41"/><path d="M451.41766,356.49473h30l4.72341,10.42578,20.091,8.95193A18.25955,18.25955,0,0,1,516.629,388.64858c7.23437,33.07129-1.9166,39.94254-2.21129,50.84615-1,37-6.15265,44.35981-5.57632,53.49367.17248,2.73358,1.84109,13.54206,7.2087,12.52419s2.47418,3.255,3.74451,4.91622c1.09758,1.43528,6.87018-.46946,3.24664,4.29823s11.8678,17.76769,2.37647,17.76769c-18,0-54,9-68,9s-24.8189,4.151-31,4c-3.7673-.092-2.58943-17.6586-1.08367-32.8717.34094-3.44456,6.95562-3.35479,1.01964-9.74155s1.05143-9.70583,1.064-11.38675c.01338-1.7857,3.36516-6.28408-.81742-13.642s-.327-4.31321-.50869-6.62366c-1.4-17.805-3.40618-40.5074-3.40618-40.5074l-8.8435-24.88973a26.04063,26.04063,0,0,1,14.98236-32.94258l10.37364-4.092Z" transform="translate(-232.41766 -107.85731)" fill="#7e58ec"/><path d="M662.11327,347.31424a9.74338,9.74338,0,0,1-14.50321,3.13865l-42.261,23.92571-9.49179-10.06228,50.40182-28.04993a9.72972,9.72972,0,0,1,15.85419,11.04785Z" transform="translate(-232.41766 -107.85731)" fill="#ffb6b6"/><path d="M471.83146,403.79l-.64357,7.70473,84.134-1.08159,83.74648-47.0804-12.24324-18.84418-73.60826,30.94875-52.316,1.06091A29.77646,29.77646,0,0,0,471.83146,403.79Z" transform="translate(-232.41766 -107.85731)" fill="#7e58ec"/><circle cx="229.26124" cy="215.82239" r="27.32215" fill="#ffb6b6"/><path d="M492.3966,311.49473c-.45594.24-.90173.46-1.35767.68-.47615.23-.95237.46-1.42852.67-9.14888,4.15-16.59558,4.61-21.1143-1.35a25.26,25.26,0,0,0-2.077-9.1,14.62658,14.62658,0,0,1-2.41133,9.1h-9.09816c-9.37174,6.22-14.18426,6.87-7.67978,27.29,1.8136,5.69,9.02462,38.8,6.18779,43.71-.82066-.09-9.61228-27.35-10.40251-27.5-17.81139-3.37-31.28642-18-31.65114-35.66.02022-.9.081-1.8.17222-2.68a47.71735,47.71735,0,0,1,3.86014-5.04,30.59344,30.59344,0,0,1,3.1712-13.61,31.30408,31.30408,0,0,1,11.8945-12.94,55.16343,55.16343,0,0,1,9.50345-3.57c.08107-.02.152-.04.233-.06,1.003-.27,2.02632-.52,3.04962-.73a56.09643,56.09643,0,0,1,6.40319-.97c.152-.01.30393-.02.44579-.02a4.82509,4.82509,0,0,1,2.44169.67c.01014,0,.01014.01.02028.01a4.59717,4.59717,0,0,1,1.35767,1.21,4.65,4.65,0,0,1,.99288,2.89h10.1316q.5623,0,1.1246.03a27.16579,27.16579,0,0,1,26.19024,25.54C492.38646,310.54472,492.3966,311.01469,492.3966,311.49473Z" transform="translate(-232.41766 -107.85731)" fill="#2f2e41"/><circle cx="192" cy="190.63742" r="18" fill="#2f2e41"/><path d="M446.41766,284.49473c.34375,9.93518-8.05888,18-18,18a18,18,0,0,1-18-18c0-9.94113,12.03943-10.044,18-18C436.84972,255.23988,445.95409,271.09634,446.41766,284.49473Z" transform="translate(-232.41766 -107.85731)" fill="#2f2e41"/><path d="M469.95239,566.07549c-2.795-41.47321,5.38725-80.48472,28.11105-116.23511a9.1398,9.1398,0,0,1,11.01963-6.7275l87.7833,21.23a9.13964,9.13964,0,0,1,6.72742,11.01957l-28.111,116.23516a9.1396,9.1396,0,0,1-11.0195,6.72747l-87.7833-21.23A9.13985,9.13985,0,0,1,469.95239,566.07549Z" transform="translate(-232.41766 -107.85731)" fill="#f2f2f2"/><path d="M487.15544,574.88366a9.13965,9.13965,0,0,1-6.72748-11.0195c-2.79509-41.4734,5.38722-80.48485,28.1109-116.23521a9.02174,9.02174,0,0,1,2.27158-4.09835l-1.7274-.41785a9.14,9.14,0,0,0-11.01965,6.72738c-22.72373,35.75044-30.906,74.76181-28.11089,116.2352A9.13961,9.13961,0,0,0,476.68,577.09484l87.7832,21.23017a9.09906,9.09906,0,0,0,8.74807-2.629Z" transform="translate(-232.41766 -107.85731)" opacity="0.2" style="isolation:isolate"/><path d="M566.6351,525.95227l-58.86472-14.06358a3.63129,3.63129,0,0,1,1.68757-7.06379l58.86472,14.06357a3.6313,3.6313,0,0,1-1.68765,7.06375Z" transform="translate(-232.41766 -107.85731)" fill="#fff"/><path d="M525.34819,495.61357l-12.95018-3.094a3.63132,3.63132,0,0,1,1.66535-7.06912l.0223.00538,12.95018,3.094a3.6313,3.6313,0,0,1-1.68765,7.06375Z" transform="translate(-232.41766 -107.85731)" fill="#fff"/><path d="M559.21584,557.0064l-58.86472-14.06358a3.63129,3.63129,0,0,1,1.68765-7.06374l58.86471,14.06357a3.63132,3.63132,0,1,1-1.66534,7.06912Z" transform="translate(-232.41766 -107.85731)" fill="#fff"/><path d="M562.92544,541.47937,504.06073,527.4158a3.63131,3.63131,0,0,1,1.67919-7.06584l.00838.002L564.613,534.41558a3.63129,3.63129,0,0,1-1.68765,7.06374Z" transform="translate(-232.41766 -107.85731)" fill="#fff"/><circle cx="318.06386" cy="345.5446" r="15.14099" fill="#3f3d56"/><path d="M474.1386,574.74359a9.74336,9.74336,0,0,1-2.952-14.54235l-23.38049-42.56507,10.18346-9.36166,27.39972,50.75822a9.72972,9.72972,0,0,1-11.25073,15.71086Z" transform="translate(-232.41766 -107.85731)" fill="#ffb6b6"/><path d="M446.83014,386.32937,421.6833,383.903a8.45373,8.45373,0,0,0-9.26564,8.41466V467.15l46,84.34475,19-12-30-74Z" transform="translate(-232.41766 -107.85731)" fill="#7e58ec"/><path d="M645.35443,380.25664c5.83076-41.1563,21.89367-77.63684,51.51111-107.92329a9.13979,9.13979,0,0,1,12.17148-4.30657l81.506,38.90226a9.13965,9.13965,0,0,1,4.3065,12.17142l-51.511,107.92336a9.13961,9.13961,0,0,1-12.17136,4.30656l-81.506-38.90226A9.13984,9.13984,0,0,1,645.35443,380.25664Z" transform="translate(-232.41766 -107.85731)" fill="#f2f2f2"/><path d="M660.36742,392.42786a9.13963,9.13963,0,0,1-4.30656-12.17135c5.83069-41.1565,21.89366-77.637,51.511-107.92342a9.02186,9.02186,0,0,1,3.069-3.54084l-1.60385-.7656a9.14,9.14,0,0,0-12.17148,4.30644c-29.61738,30.28651-45.68028,66.76692-51.511,107.92342a9.1396,9.1396,0,0,0,4.30657,12.17135L731.167,431.33025a9.09907,9.09907,0,0,0,9.10244-.76559Z" transform="translate(-232.41766 -107.85731)" opacity="0.2" style="isolation:isolate"/><path d="M748.23935,360.96643l-54.691-25.91774a3.6313,3.6313,0,0,1,3.11008-6.563l54.691,25.91774a3.6313,3.6313,0,0,1-3.11015,6.5629Z" transform="translate(-232.41766 -107.85731)" fill="#fff"/><path d="M714.10846,322.75481l-12.032-5.7019a3.63132,3.63132,0,1,1,3.08943-6.57277l.02071.00987,12.032,5.7019a3.63129,3.63129,0,0,1-3.11014,6.5629Z" transform="translate(-232.41766 -107.85731)" fill="#fff"/><path d="M734.56641,389.81873l-54.691-25.91774a3.63129,3.63129,0,0,1,3.11014-6.5629l54.691,25.91774a3.63131,3.63131,0,1,1-3.08943,6.57276Z" transform="translate(-232.41766 -107.85731)" fill="#fff"/><path d="M741.40285,375.39261l-54.691-25.91774a3.63131,3.63131,0,0,1,3.1023-6.56669l.00778.00372,54.691,25.91775a3.63129,3.63129,0,0,1-3.11014,6.56289Z" transform="translate(-232.41766 -107.85731)" fill="#fff"/><circle cx="515.00026" cy="178.78672" r="15.14099" fill="#3f3d56"/><path d="M878.07666,433.57385c-16.42084-35.62276-23.61165-74.01453-18.57537-116.07437-.7781-4.89295,1.94935-9.79626,6.09693-10.96083l74.34318-20.77016c4.14933-1.15345,8.1455,1.87143,8.933,6.76177l18.57545,116.07437c.7781,4.893-1.94928,9.79627-6.09684,10.96075l-74.34318,20.77017C882.86046,441.489,878.8642,438.4642,878.07666,433.57385Z" transform="translate(-232.41766 -107.85731)" fill="#f2f2f2"/><path d="M894.24685,433.637c-4.14933,1.15344-8.14544-1.87133-8.933-6.76168-16.421-35.62287-23.61172-74.01463-18.57553-116.07439a10.72776,10.72776,0,0,1,.32275-4.671l-1.46295.40864c-4.14749,1.16458-6.87493,6.0678-6.097,10.96073-5.0362,42.05984,2.15454,80.45152,18.57552,116.07439.78746,4.89034,4.78365,7.91512,8.933,6.76168l74.34315-20.77a8.8344,8.8344,0,0,0,5.77425-6.28968Z" transform="translate(-232.41766 -107.85731)" opacity="0.2" style="isolation:isolate"/><path d="M938.0804,354.21777,888.28767,368.2991c-1.65036.46429-3.2429-.73666-3.55708-2.68263a3.85819,3.85819,0,0,1,2.41235-4.362l49.79274-14.08133c1.65095-.46048,3.24134.74447,3.55223,2.69123a3.85872,3.85872,0,0,1-2.40758,4.3534Z" transform="translate(-232.41766 -107.85731)" fill="#fff"/><path d="M896.10336,345.88453,885.149,348.98239c-1.649.47276-3.24623-.71986-3.56753-2.66367a3.8617,3.8617,0,0,1,2.404-4.37567l.01889-.00529,10.95436-3.09786c1.651-.46048,3.24134.74447,3.55223,2.69123A3.85871,3.85871,0,0,1,896.10336,345.88453Z" transform="translate(-232.41766 -107.85731)" fill="#fff"/><path d="M943.11266,385.18782l-49.79274,14.08134c-1.651.46048-3.24134-.74448-3.55223-2.69123a3.85871,3.85871,0,0,1,2.40759-4.3534L941.968,378.14319c1.649-.47276,3.24623.71985,3.56754,2.66367a3.8617,3.8617,0,0,1-2.404,4.37566Z" transform="translate(-232.41766 -107.85731)" fill="#fff"/><path d="M940.59652,369.70284l-49.79273,14.08134c-1.64963.46894-3.2447-.72749-3.56278-2.67219a3.85923,3.85923,0,0,1,2.411-4.37048l.0071-.002L939.4518,362.6582c1.65095-.46048,3.24134.74447,3.55223,2.69123a3.85872,3.85872,0,0,1-2.40758,4.3534Z" transform="translate(-232.41766 -107.85731)" fill="#fff"/><ellipse cx="900.75374" cy="296.98982" rx="15.14099" ry="12.63838" transform="translate(258.37038 1044.40346) rotate(-82.63777)" fill="#3f3d56"/></svg>
        ');
    }




    protected function getPlanInfoDetails(): HtmlString
    {
        if ($this->plan && is_array($this->plan->features)) {
            // Start the HTML for the plan info
            $featuresHtml = '
        <div class="p-2 border-2 rounded-lg">
            <div class="w-full p-1 mb-2">
                <h1 class="text-center font-semibold text-lg">' . ucwords($this->plan->name) . '</h1>
                <div class="flex justify-between items-center w-full px-2">
                    <span class="text-left font-medium">Available Auth: ' . $this->plan->auth_type . '</span>
                    <span class="text-right font-medium">Price: ' . Money::format($this->plan->price) . '/month</span>
                </div>
                <p class="text-center w-full text-sm px-2">' . $this->plan->desc . '</p>
            </div>

            <div class="flex space-x-4 gap-2">'; // Use flexbox for side-by-side tables

            // Split the features array in half
            $half = ceil(count($this->plan->features) / 2);
            $firstHalf = array_slice($this->plan->features, 0, $half);
            $secondHalf = array_slice($this->plan->features, $half);

            // First half of features in the first table
            $featuresHtml .= '
            <div class="flex-1 px-2"> <!-- Allow the table to flex -->
                <table class="w-full rounded-lg mb-2 mt-2" style="border-collapse: collapse; border: 1px solid #ccc;">
                    <thead>
                        <tr>
                            <th style="padding: 8px 16px; border: 1px solid #ccc; text-align: left;">Feature</th>
                            <th class="font-semibold text-center" style="padding: 8px 16px; border: 1px solid #ccc;">Value</th>
                        </tr>
                    </thead>
                    <tbody>';

            foreach ($firstHalf as $key => $value) {
                $formattedKey = ucwords(str_replace('_', ' ', $key));
                if (is_bool($value)) {
                    $value = $value ? 'Yes' : 'No';
                }

                $featuresHtml .= '
                <tr>
                    <td style="padding: 8px 16px; border: 1px solid #ccc; text-align: left;">' . $formattedKey . '</td>
                    <td class="font-normal text-sm text-center px-2 py-1 border-2">' . (empty($value) ? 'Not Available' : $value) . '</td>
                </tr>';
            }

            $featuresHtml .= '
                </tbody>
            </table>
            </div>'; // Close the first table wrapper

            // Second half of features in the second table
            $featuresHtml .= '
            <div class="flex-1 px-2"> <!-- Allow the table to flex -->
                <table class="w-full rounded-lg mb-2 mt-2" style="border-collapse: collapse; border: 1px solid #ccc;">
                    <thead>
                        <tr>
                            <th style="padding: 8px 16px; border: 1px solid #ccc; text-align: left;">Feature</th>
                            <th class="font-semibold text-center" style="padding: 8px 16px; border: 1px solid #ccc;">Value</th>
                        </tr>
                    </thead>
                    <tbody>';

            foreach ($secondHalf as $key => $value) {
                $formattedKey = ucwords(str_replace('_', ' ', $key));
                if (is_bool($value)) {
                    $value = $value ? 'Yes' : 'No';
                }

                $featuresHtml .= '
                <tr>
                    <td style="padding: 8px 16px; border: 1px solid #ccc; text-align: left;">' . $formattedKey . '</td>
                    <td class="font-normal text-sm text-center px-2 py-1 border-2">' . (empty($value) ? 'Not Available' : $value) . '</td>
                </tr>';
            }

            $featuresHtml .= '
                </tbody>
            </table>
            </div>'; // Close the second table wrapper

            // Close the flex container
            $featuresHtml .= '
            </div>
        </div>';

            return new HtmlString($featuresHtml);
        }

        return new HtmlString('<p>No features available.</p>');
    }





}
